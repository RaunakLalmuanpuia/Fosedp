import{Q as ae,a as I}from"./QBreadcrumbs-f1fcde01.js";import{a1 as oe,h as b,r as P,T as A,o as c,e as F,a as s,d as a,w as i,Q as g,av as E,m as se,u as j,c as h,f as _,F as z,aw as B,p as H,s as L,x as M,k as ie,n as de,b as re,t as ue,aH as ce,ax as me,C as pe}from"./app-a7abb58d.js";import{Q as x}from"./QSelect-57ce204b.js";import{Q as fe}from"./QForm-ea84dcf4.js";import{Q as V}from"./QChip-85d4182d.js";import{Q as be}from"./QTable-33cc80a5.js";import"./rtl-36dd996b.js";import"./use-fullscreen-7c8ce305.js";const ge={class:"flex justify-between items-center"},ye=s("p",{class:"page-header"},"Applications",-1),ve=s("br",null,null,-1),he={class:"flex justify-between items-center"},_e={class:"flex q-gutter-sm"},we=s("p",{class:"text-color text-lg q-my-sm"},"Filter",-1),ke={class:"flex q-gutter-sm q-mt-md"},xe={key:0,class:"flex items-baseline q-gutter-sm q-mt-md"},Ve=s("p",{class:"text-bold text-primary"},"Filter :",-1),Ce=s("br",null,null,-1),Qe={align:"right"},Se={class:"flex q-gutter-sm justify-end"},$e={__name:"Index",props:["search","list","departments","districts","filter"],setup(w){var R,D,N,T;const d=w,O=[{name:"sn",align:"left",label:"SN",field:"id"},{name:"head_of_family",align:"left",label:"Head of Family",field:"head_of_family"},{name:"mobile",align:"left",label:"Mobile",field:"mobile"},{name:"epic_no",align:"left",label:"Epic no",field:"epic_no"},{name:"district",align:"left",label:"District",field:"district",format:l=>l==null?void 0:l.name},{name:"constituency",align:"left",label:"Constituency",field:"constituency",format:l=>l==null?void 0:l.name},{name:"department",align:"left",label:"Department",field:"department",format:l=>l==null?void 0:l.name},{name:"trade",align:"left",label:"Trade",field:"trade",format:l=>l==null?void 0:l.name},{name:"action",label:"Action",field:"id"}],r=oe(),Y=b(d.list.data||[]),C=b(!1),m=b({page:d.list.current_page,rowsPerPage:d.list.per_page,rowsNumber:d.list.total}),Q=b([]),S=b(d.search),U=b([{name:"head_of_family",selected:!0},{name:"mobile",selected:!0},{name:"district",selected:!0},{name:"constituency",selected:!0},{name:"department",selected:!0},{name:"trade",selected:!0}]),t=P({district:((R=d.filter)==null?void 0:R.district)||null,constituency:((D=d.filter)==null?void 0:D.constituency)||null,department:((N=d.filter)==null?void 0:N.department)||null,trade:((T=d.filter)==null?void 0:T.trade)||null}),p=P({trades:[],constituencies:[]}),G=A(l=>U.value.filter(e=>e.selected).map(e=>e.name)),J=A(()=>!!t.department||!!t.constituency||!!t.trade||!!t.district),k=l=>{switch(l){case"district":t.district=null;break;case"constituency":t.constituency=null;break;case"department":t.department=null;break;case"trade":t.trade=null;break}y({pagination:m})},K=l=>{y({pagination:m})},W=l=>{r.dialog({title:"Confirm Delete",message:"Do you want to delete",ok:"Yes",cancel:"No"}).onOk(()=>{B.delete(route("application.destroy",l.id),{onStart:e=>r.loading.show({message:"Deleting..."}),onFinish:e=>r.loading.hide(),preserveState:!1})})},X=(l,e,o)=>B.get(route("application.show",e.id)),Z=l=>{y({pagination:m})},ee=l=>{t.district=null,t.trade=null,t.constituency=null,t.department=null,y({pagination:m})},te=l=>{l&&(t.constituency=null,r.loading.show(),axios.get(route("option.district.constituencies",l.value)).then(e=>{const{list:o}=e.data;p.constituencies=o}).catch(e=>{var o,u;r.notify({type:"negative",message:((u=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:u.message)||e.toString()})}).finally(()=>r.loading.hide()))},le=l=>{l&&(t.trade=null,r.loading.show(),axios.get(route("option.department.trades",l.value)).then(e=>{const{list:o}=e.data;p.trades=o}).catch(e=>{var o,u;r.notify({type:"negative",message:((u=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:u.message)||e.toString()})}).finally(()=>r.loading.hide()))};function y(l){var v,n,f,$;const{page:e,rowsPerPage:o,sortBy:u,descending:q}=l.pagination;B.get(route("application.index"),{per_page:o,page:e,filter_district_id:(v=t==null?void 0:t.district)==null?void 0:v.value,filter_constituency_id:(n=t==null?void 0:t.constituency)==null?void 0:n.value,filter_trade_id:(f=t==null?void 0:t.trade)==null?void 0:f.value,filter_department_id:($=t==null?void 0:t.department)==null?void 0:$.value,search:S.value},{preserveState:!1,onStart:ne=>C.value=!0,onFinish:ne=>C.value=!1})}return(l,e)=>{var o,u,q,v;return c(),F(z,null,[s("div",ge,[s("div",null,[ye,a(ae,null,{default:i(()=>[a(I,{href:l.route("dashboard"),icon:"o_dashboard",label:"Dashboard"},null,8,["href"]),a(I,{class:"text-color",label:"Applications"})]),_:1})]),s("div",null,[a(g,{disable:Q.value.length<=0,color:"accent",label:"Bulk Forward","no-caps":""},null,8,["disable"]),a(E,{class:"q-pa-xs","dropdown-icon":"more_vert",flat:""},{default:i(()=>[a(H,null,{default:i(()=>[a(L,null,{default:i(()=>[a(M,null,{default:i(()=>[ie("Visible Column")]),_:1})]),_:1}),a(L,null,{default:i(()=>[a(M,null,{default:i(()=>[(c(!0),F(z,null,de(U.value,n=>(c(),h(me,{modelValue:n.selected,"onUpdate:modelValue":f=>n.selected=f,label:n.name,val:""},null,8,["modelValue","onUpdate:modelValue","label"]))),256))]),_:1})]),_:1})]),_:1})]),_:1})])]),ve,s("div",he,[s("div",null,[a(se,{modelValue:S.value,"onUpdate:modelValue":[e[0]||(e[0]=n=>S.value=n),K],autofocus:"",debounce:800,dense:"",outlined:"",placeholder:"Type here..."},null,8,["modelValue"])]),s("div",_e,[a(g,{color:"dark",label:"Export To CSV","no-caps":"",outline:""}),a(E,{"dropdown-icon":"o_sort",flat:""},{default:i(()=>[a(H,{class:"q-pa-md",style:{"min-width":"250px"}},{default:i(()=>[we,a(fe,{onSubmit:Z},{default:i(()=>[a(x,{modelValue:t.district,"onUpdate:modelValue":[e[1]||(e[1]=n=>t.district=n),te],options:w.districts,label:"District"},null,8,["modelValue","options"]),a(x,{modelValue:t.constituency,"onUpdate:modelValue":e[2]||(e[2]=n=>t.constituency=n),options:p.constituencies,label:"Constituency"},null,8,["modelValue","options"]),a(x,{modelValue:t.department,"onUpdate:modelValue":[e[3]||(e[3]=n=>t.department=n),le],options:w.departments,label:"Department"},null,8,["modelValue","options"]),a(x,{modelValue:t.trade,"onUpdate:modelValue":e[4]||(e[4]=n=>t.trade=n),options:p==null?void 0:p.trades,label:"Trade"},null,8,["modelValue","options"]),s("div",ke,[a(g,{type:"submit",color:"primary",label:"Apply"}),re(a(g,{color:"negative",label:"Clear",outline:"",onClick:ee},null,512),[[pe]])])]),_:1})]),_:1})]),_:1})])]),j(J)?(c(),F("div",xe,[Ve,t.district!=null?(c(),h(V,{key:0,label:(o=t.district)==null?void 0:o.label,removable:"",onRemove:e[5]||(e[5]=n=>k("district"))},null,8,["label"])):_("",!0),t.constituency!=null?(c(),h(V,{key:1,label:(u=t.constituency)==null?void 0:u.label,removable:"",onRemove:e[6]||(e[6]=n=>k("constituency"))},null,8,["label"])):_("",!0),t.department!=null?(c(),h(V,{key:2,label:(q=t.department)==null?void 0:q.label,removable:"",onRemove:e[7]||(e[7]=n=>k("department"))},null,8,["label"])):_("",!0),t.trade!=null?(c(),h(V,{key:3,label:(v=t.trade)==null?void 0:v.label,removable:"",onRemove:e[8]||(e[8]=n=>k("trade"))},null,8,["label"])):_("",!0)])):_("",!0),Ce,a(be,{pagination:m.value,"onUpdate:pagination":e[9]||(e[9]=n=>m.value=n),selected:Q.value,"onUpdate:selected":e[10]||(e[10]=n=>Q.value=n),columns:O,filter:w.filter,loading:C.value,rows:Y.value,"rows-per-page-options":[1,7,15,30,50],"visible-columns":j(G),"binary-state-sort":"",flat:"","row-key":"id",selection:"multiple","table-class":"text-color","table-header-class":"table-header",onRequest:y,onRowClick:X},{"body-cell-sn":i(n=>[s("td",null,ue(n.rowIndex+1),1)]),"body-cell-action":i(n=>[s("td",Qe,[s("div",Se,[a(g,{icon:"edit",outline:"",size:"sm",onClick:f=>l.$inertia.get(l.route("district.edit",n.row.id))},null,8,["onClick"]),a(g,{icon:"delete",outline:"",size:"sm",onClick:ce(f=>W(n.row),["stop"])},null,8,["onClick"])])])]),_:1},8,["pagination","selected","filter","loading","rows","visible-columns"])],64)}}};export{$e as default};
