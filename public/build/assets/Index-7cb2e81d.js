import{Q as ae,a as $}from"./QBreadcrumbs-f1fcde01.js";import{a1 as oe,h as f,r as I,T as E,o as c,e as T,a as s,d as a,w as r,av as P,m as se,Q as h,u as j,c as k,f as _,F as O,aw as C,p as z,s as H,x as L,k as ie,n as de,b as re,aH as M,ax as ue,C as ce}from"./app-a7abb58d.js";import{Q}from"./QSelect-57ce204b.js";import{Q as me}from"./QForm-ea84dcf4.js";import{Q as q}from"./QChip-85d4182d.js";import{Q as pe}from"./QTable-33cc80a5.js";import"./rtl-36dd996b.js";import"./use-fullscreen-7c8ce305.js";const fe={class:"flex justify-between items-center"},be=s("p",{class:"page-header"},"Incoming",-1),ge=s("br",null,null,-1),ye={class:"flex justify-between items-center"},ve={class:"flex q-gutter-sm"},he=["href"],ke=s("p",{class:"text-color text-lg q-my-sm"},"Filter",-1),_e={class:"flex q-gutter-sm q-mt-md"},we={key:0,class:"flex items-baseline q-gutter-sm q-mt-md"},xe=s("p",{class:"text-bold text-primary"},"Filter :",-1),Ve=s("br",null,null,-1),Ce={align:"right"},Qe={class:"flex justify-end q-gutter-sm"},De={__name:"Index",props:["search","list","departments","districts","filter"],setup(w){var B,N,R,D;const u=w,Y=[{name:"sn",align:"left",label:"SN",field:"id"},{name:"head_of_family",align:"left",label:"Head of Family",field:"head_of_family"},{name:"mobile",align:"left",label:"Mobile",field:"mobile"},{name:"epic_no",align:"left",label:"Epic no",field:"epic_no"},{name:"district",align:"left",label:"District",field:"district",format:l=>l==null?void 0:l.name},{name:"constituency",align:"left",label:"Constituency",field:"constituency",format:l=>l==null?void 0:l.name},{name:"department",align:"left",label:"Department",field:"department",format:l=>l==null?void 0:l.name},{name:"trade",align:"left",label:"Trade",field:"trade",format:l=>l==null?void 0:l.name}],i=oe(),A=f(u.list.data||[]),S=f(!1),m=f({page:u.list.current_page,rowsPerPage:u.list.per_page,rowsNumber:u.list.total}),x=f([]),F=f(u.search),U=f([{name:"head_of_family",selected:!0},{name:"mobile",selected:!0},{name:"district",selected:!0},{name:"constituency",selected:!0},{name:"department",selected:!0},{name:"trade",selected:!0}]),t=I({district:((B=u.filter)==null?void 0:B.district)||null,constituency:((N=u.filter)==null?void 0:N.constituency)||null,department:((R=u.filter)==null?void 0:R.department)||null,trade:((D=u.filter)==null?void 0:D.trade)||null}),p=I({trades:[],constituencies:[]}),G=E(l=>U.value.filter(e=>e.selected).map(e=>e.name)),J=E(()=>!!t.department||!!t.constituency||!!t.trade||!!t.district),V=l=>{switch(l){case"district":t.district=null;break;case"constituency":t.constituency=null;break;case"department":t.department=null;break;case"trade":t.trade=null;break}b({pagination:m})},K=l=>{i.dialog({title:"Confirmation",message:"Do you want to take it",ok:"Yes",cancel:"No"}).onOk(()=>{C.post(route("application.bulk-take"),{ids:x.value.map(e=>e.id)},{preserveState:!1,onStart:e=>i.loading.show({message:"Taking..."}),onFinish:e=>i.loading.hide()})})},W=l=>{b({pagination:m})},X=l=>{i.dialog({title:"Confirm Delete",message:"Do you want to delete",ok:"Yes",cancel:"No"}).onOk(()=>{C.delete(route("application.destroy",l.id),{onStart:e=>i.loading.show({message:"Deleting..."}),onFinish:e=>i.loading.hide(),preserveState:!1})})},Z=(l,e,o)=>C.get(route("application.show",e.id)),ee=l=>{b({pagination:m})},te=l=>{t.district=null,t.trade=null,t.constituency=null,t.department=null,b({pagination:m})},le=l=>{l&&(t.constituency=null,i.loading.show(),axios.get(route("option.district.constituencies",l.value)).then(e=>{const{list:o}=e.data;p.constituencies=o}).catch(e=>{var o,d;i.notify({type:"negative",message:((d=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:d.message)||e.toString()})}).finally(()=>i.loading.hide()))},ne=l=>{l&&(t.trade=null,i.loading.show(),axios.get(route("option.department.trades",l.value)).then(e=>{const{list:o}=e.data;p.trades=o}).catch(e=>{var o,d;i.notify({type:"negative",message:((d=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:d.message)||e.toString()})}).finally(()=>i.loading.hide()))};function b(l){var d,g,y,n;const{page:e,rowsPerPage:o}=l.pagination;C.get(route("application.incoming"),{per_page:o,page:e,filter_district_id:(d=t==null?void 0:t.district)==null?void 0:d.value,filter_constituency_id:(g=t==null?void 0:t.constituency)==null?void 0:g.value,filter_trade_id:(y=t==null?void 0:t.trade)==null?void 0:y.value,filter_department_id:(n=t==null?void 0:t.department)==null?void 0:n.value,search:F.value},{preserveState:!1,onStart:v=>S.value=!0,onFinish:v=>S.value=!1})}return(l,e)=>{var o,d,g,y;return c(),T(O,null,[s("div",fe,[s("div",null,[be,a(ae,null,{default:r(()=>[a($,{href:l.route("dashboard"),icon:"o_dashboard",label:"Dashboard"},null,8,["href"]),a($,{class:"text-color",label:"Incoming"})]),_:1})]),s("div",null,[a(P,{class:"q-pa-xs","dropdown-icon":"more_vert",flat:""},{default:r(()=>[a(z,null,{default:r(()=>[a(H,null,{default:r(()=>[a(L,null,{default:r(()=>[ie("Visible Column")]),_:1})]),_:1}),a(H,null,{default:r(()=>[a(L,null,{default:r(()=>[(c(!0),T(O,null,de(U.value,n=>(c(),k(ue,{modelValue:n.selected,"onUpdate:modelValue":v=>n.selected=v,label:n.name,val:""},null,8,["modelValue","onUpdate:modelValue","label"]))),256))]),_:1})]),_:1})]),_:1})]),_:1})])]),ge,s("div",ye,[s("div",null,[a(se,{modelValue:F.value,"onUpdate:modelValue":[e[0]||(e[0]=n=>F.value=n),W],autofocus:"",debounce:800,dense:"",outlined:"",placeholder:"Type here..."},null,8,["modelValue"])]),s("div",ve,[s("a",{href:l.route("export.incoming-application"),class:"q-btn q-btn-item non-selectable no-outline q-btn--outline q-btn--rectangle q-btn--actionable q-focusable q-hoverable"},"Export To Excel",8,he),a(h,{color:"accent",disable:x.value.length<=0,onClick:K,label:"Take","no-caps":""},null,8,["disable"]),a(P,{"dropdown-icon":"o_sort",flat:""},{default:r(()=>[a(z,{class:"q-pa-md",style:{"min-width":"250px"}},{default:r(()=>[ke,a(me,{onSubmit:ee},{default:r(()=>[a(Q,{modelValue:t.district,"onUpdate:modelValue":[e[1]||(e[1]=n=>t.district=n),le],options:w.districts,label:"District"},null,8,["modelValue","options"]),a(Q,{modelValue:t.constituency,"onUpdate:modelValue":e[2]||(e[2]=n=>t.constituency=n),options:p.constituencies,label:"Constituency"},null,8,["modelValue","options"]),a(Q,{modelValue:t.department,"onUpdate:modelValue":[e[3]||(e[3]=n=>t.department=n),ne],options:w.departments,label:"Department"},null,8,["modelValue","options"]),a(Q,{modelValue:t.trade,"onUpdate:modelValue":e[4]||(e[4]=n=>t.trade=n),options:p==null?void 0:p.trades,label:"Trade"},null,8,["modelValue","options"]),s("div",_e,[a(h,{type:"submit",color:"primary",label:"Apply"}),re(a(h,{color:"negative",label:"Clear",outline:"",onClick:te},null,512),[[ce]])])]),_:1})]),_:1})]),_:1})])]),j(J)?(c(),T("div",we,[xe,t.district!=null?(c(),k(q,{key:0,label:(o=t.district)==null?void 0:o.label,removable:"",onRemove:e[5]||(e[5]=n=>V("district"))},null,8,["label"])):_("",!0),t.constituency!=null?(c(),k(q,{key:1,label:(d=t.constituency)==null?void 0:d.label,removable:"",onRemove:e[6]||(e[6]=n=>V("constituency"))},null,8,["label"])):_("",!0),t.department!=null?(c(),k(q,{key:2,label:(g=t.department)==null?void 0:g.label,removable:"",onRemove:e[7]||(e[7]=n=>V("department"))},null,8,["label"])):_("",!0),t.trade!=null?(c(),k(q,{key:3,label:(y=t.trade)==null?void 0:y.label,removable:"",onRemove:e[8]||(e[8]=n=>V("trade"))},null,8,["label"])):_("",!0)])):_("",!0),Ve,a(pe,{pagination:m.value,"onUpdate:pagination":e[9]||(e[9]=n=>m.value=n),selected:x.value,"onUpdate:selected":e[10]||(e[10]=n=>x.value=n),columns:Y,filter:w.filter,loading:S.value,rows:A.value,"rows-per-page-options":[7,15,30,50,100,200],"visible-columns":j(G),flat:"","row-key":"id",selection:"multiple","table-class":"text-color","table-header-class":"table-header",onRequest:b,onRowClick:Z},{"body-cell-action":r(n=>[s("td",Ce,[s("div",Qe,[a(h,{onClick:M(v=>l.$inertia.get(l.route("application.edit",n.row.id)),["stop"]),size:"sm",icon:"edit",outline:""},null,8,["onClick"]),a(h,{onClick:M(v=>X(n.row),["stop"]),size:"sm",icon:"delete",outline:""},null,8,["onClick"])])])]),_:1},8,["pagination","selected","filter","loading","rows","visible-columns"])],64)}}};export{De as default};
